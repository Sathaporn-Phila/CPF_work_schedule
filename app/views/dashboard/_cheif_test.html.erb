<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="app/assets/stylesheet/style.css.scss" rel="stylesheet">
    <title> cheif_test </title>
</head>
<body>
    <div class="d-flex flex-row align-items-center">
        <div class="d-flex flex-column flex-grow-1">
            <div class="display-font"> ชื่อ-นามสกุล : <%=@current_user.name %> </div>
            <div class="display-font"> แผนก : <%= @current_user.department %> </div>
            <div class="display-font"> จำนวนแผนกที่ดูแล : <%= @current_user.factory %></div>
        </div>
        <div class="flex-grow-1 align-items-center">
            <% if @actual_time.where(user_id: @current_user.id).length == 0%>
                <%= link_to timestamp_path(@current_user) do%>
                    <i class="bi bi-chevron-double-right btn btn-primary" id="logout-button" aria-hidden="true"> Check-IN </i>
            <%end%>
            <% else %>
                <%= link_to timestamp_path(@current_user) do%>
                    <i class="bi bi-chevron-double-right btn btn-red" id="logout-button" aria-hidden="true"> Check-OUT </i>
                <% end %>
            <% end %>
        </div>
    </div>
    <div id="mySidepanel" class="sidepanel">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">ปิด ×</a>
        <a onclick="openPage('work1')" style="text-color: #5BA8A0" id="defaultOpen">ถอนขน</a>
        <a onclick="openPage('work2')" style="text-color: #CBE54E">ไก่ตกราว</a>
        <a onclick="openPage('work3')" style="text-color: #94B447">เชือดไก่</a>
        <a onclick="openPage('work4')" style="text-color: #5D6E1E">สินค้าแช่แข็ง</a>
    </div>

    <button class="openbtn" onclick="openNav()">☰ แผนก</button>  
    <div id="work1" class="tabcontent">
            <div class="display-font h3 text-center">
                จำนวนพนักงาน(ที่มี/ต้องการ) <%=User.where(role:'คนงานทั่วไป',factory:@current_user.factory,department:"งานถอนขน").length%> / Plan %>
            </div>
            <table class="table table-striped table-light" border="1" width="50%" cellspacing='0' cellpadding='10'>
                <thead>
                    <th>ชื่อ-นามสกุล</th>
                    <th>เวลา-เข้า</th>
                    <th>เวลา-ออก</th>
                    <th> โรงงาน </th>
                </thead>
                <tbody id="time_object">
                    <% @actual_time.each do |row|%>
                        <tr id=<%= User.find(row.user_id).name%>>
                            <% unless User.where(id:row.user_id,role:'คนงานทั่วไป',department: "งานถอนขน").length == 0%>
                                <td><%= User.find(row.user_id).name%></td>
                                <td><%= row.time_in.strftime("%H:%M:%S")%></td>
                                <% if row.time_out.nil?%>
                                    <td>#</td>
                                <% else %>
                                    <td><%= row.time_out.strftime("%H:%M:%S")%></td>
                                <% end %>
                                <td><%= User.find(row.user_id).factory%></td>
                                <td> </td>
                            <%end%>
                        </tr>
                    <%end%>                       
                </tbody>
            </table>
            <div class="text-center"> <!-- d-flex align-items-center justify-content-center -->
                <%= link_to register_user_path do %><i class="bi bi-plus btn btn-primary col-6 mx-auto">Add person</i><%end%>
            </div> 
        </div>

        <div id="work2" class="tabcontent">
            <div class="display-font h3 text-center">
                จำนวนพนักงาน(ที่มี/ต้องการ) <%=User.where(role:'คนงานทั่วไป',factory:@current_user.factory,department:"งานไก่ตกราว").length%> / Plan %>
            </div>
            <table class="table table-striped" border="1" width="50%" cellspacing='0' cellpadding='10'>
                <thead>
                    <th>ชื่อ-นามสกุล</th>
                    <th>เวลา-เข้า</th>
                    <th>เวลา-ออก</th>
                    <th> โรงงาน </th>
                </thead>
                <tbody id="time_object">
                    <% @actual_time.each do |row|%>
                        <tr id=<%= User.find(row.user_id).name%>>
                            <% unless User.where(id:row.user_id,role:'คนงานทั่วไป',department:"งานไก่ตกราว").length == 0%>
                                <td><%= User.find(row.user_id).name%></td>
                                <td ><%= row.time_in.strftime("%H:%M:%S")%></td>
                                <% if row.time_out.nil?%>
                                    <td>#</td>
                                <% else %>
                                    <td><%= row.time_out.strftime("%H:%M:%S")%></td>
                                <% end %>
                                <td><%= User.find(row.user_id).factory%></td>
                            <%end%>
                        </tr>
                    <%end%>                       
                </tbody>
            </table>
            <div class="text-center"> <!-- d-flex align-items-center justify-content-center -->
                <%= link_to register_user_path do %><i class="bi bi-plus btn btn-primary col-6 mx-auto">Add person</i><%end%>
            </div> 
        </div>
        <div id="work3" class="tabcontent">
            <div class="display-font h3 text-center">
                จำนวนพนักงาน(ที่มี/ต้องการ) <%=User.where(role:'คนงานทั่วไป',factory:@current_user.factory,department:"งานเชือดไก่").length%> / Plan
            </div>
            <table class="table table-striped" border="1" width="50%" cellspacing='0' cellpadding='10'>
                <thead>
                    <th>ชื่อ-นามสกุล</th>
                    <th>เวลา-เข้า</th>
                    <th>เวลา-ออก</th>
                    <th> โรงงาน </th>
                </thead>
                <tbody id="time_object">
                    <% @actual_time.each do |row|%>
                        <tr id=<%= User.find(row.user_id).name%>>
                            <% unless User.where(id:row.user_id,role:'คนงานทั่วไป',department:"งานเชือดไก่").length == 0%>
                                <td><%= User.find(row.user_id).name%></td>
                                <td ><%= row.time_in.strftime("%H:%M:%S")%></td>
                                <% if row.time_out.nil?%>
                                    <td>#</td>
                                <% else %>
                                    <td><%= row.time_out.strftime("%H:%M:%S")%></td>
                                <% end %>
                                <td><%= User.find(row.user_id).factory%></td>
                            <%end%>
                        </tr>
                    <%end%>                       
                </tbody>
            </table>
            <div class="text-center"> <!-- d-flex align-items-center justify-content-center -->
                <%= link_to register_user_path do %><i class="bi bi-plus btn btn-primary col-6 mx-auto">Add person</i><%end%>
            </div> 
        </div>

        <div id="work4" class="tabcontent">
            <div class="display-font h3 text-center">
                จำนวนพนักงาน(ที่มี/ต้องการ) <%=User.where(role:'คนงานทั่วไป',factory:@current_user.factory,department:"งานจัดเก็บและจ่ายสินค้าแช่แข็ง").length%> / Plan %>
            </div>
            <table class="table table-striped" border="1" width="50%" cellspacing='0' cellpadding='10'>
                <thead>
                    <th>ชื่อ-นามสกุล</th>
                    <th>เวลา-เข้า</th>
                    <th>เวลา-ออก</th>
                    <th> โรงงาน </th>
                </thead>
                <tbody id="time_object">
                    <% @actual_time.each do |row|%>
                        <tr id=<%= User.find(row.user_id).name%> >
                            <% unless User.where(id:row.user_id,role:'คนงานทั่วไป',department: "งานจัดเก็บและจ่ายสินค้าแช่แข็ง").length == 0%>
                                <td><%= User.find(row.user_id).name%></td>
                                <td ><%= row.time_in.strftime("%H:%M:%S")%></td>
                                <% if row.time_out.nil?%>
                                    <td>#</td>
                                <% else %>
                                    <td><%= row.time_out.strftime("%H:%M:%S")%></td>
                                <% end %>
                                <td><%= User.find(row.user_id).factory%></td>
                            <%end%>
                        </tr>
                    <%end%>                       
                </tbody>
            </table>
            <div class="text-center"> <!-- d-flex align-items-center justify-content-center -->
                <%= link_to register_user_path do %><i class="bi bi-plus btn btn-primary col-6 mx-auto">Add person</i><%end%>
            </div> 
    </div>

    <!-- full page tab script -->
    <script> 
        function openPage(pageName,elmnt,color) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = "";
        }
        document.getElementById(pageName).style.display = "block";
        elmnt.style.backgroundColor = color;
        }
        document.getElementById("defaultOpen").click();

        function openNav() {
            document.getElementById("mySidepanel").style.width = "250px";
        }

        function closeNav() {
            document.getElementById("mySidepanel").style.width = "0";
        }
    </script>
    <div class="text-center d-grid" style="position: fixed; bottom:0px; height:40px; left:0px; right:0px; overflow:hidden">
        <%=link_to "จัดการเวลาทำงาน",manage_user_path,class:"btn btn-info display-font"%>
    </div>
</body>
</html>
